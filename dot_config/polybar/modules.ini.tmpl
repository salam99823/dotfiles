;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
;
;      __  ___          __      __
;     /  |/  ____  ____/ __  __/ ___  _____
;    / /|_/ / __ \/ __  / / / / / _ \/ ___/
;   / /  / / /_/ / /_/ / /_/ / /  __(__  )
;  /_/  /_/\____/\__,_/\__,_/_/\___/____/
;
;
;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;
{{- define "key" }}{{ prepend . "format" | compact | join "-" }}{{ end }}
[module/mpd]
type = internal/mpd
format-online = <label-song> %{T2}{{ .separators.component.left }}%{T-} <label-time>
{{- block "style" dict "separator" .separators.section.left "section" 0 "side" "l" "name" "online" }}
{{ template "key" list .name "background" }} = ${colors.{{ index (list "blue" "fg_gutter") .section }}}
{{ template "key" list .name "foreground" }} = ${colors.{{ index (list "black" "blue") .section }}}
{{ template "key" list .name "prefix" }} = {{ eq .side "l" | ternary "\" \"" (list "\"%{T2}" .separator (hasKey . "component" | ternary "%{T-} " "█%{T-}") "\"" | join "") }}
{{ template "key" list .name "suffix" }} = {{ ne .side "l" | ternary "\" \"" (list "\"" (hasKey . "component" | ternary " %{T2}" "%{T2}█") .separator "%{T-}\"" | join "") }}
{{ if hasKey . "component" | not }}
{{ template "key" list .name (eq .side "l" | ternary "suffix" "prefix") "foreground" }} = "${self.{{ template "key" list .name "background" }}}"
{{ template "key" list .name (eq .side "l" | ternary "suffix" "prefix") "background" }} = "${colors.{{ index (list "fg_gutter" "bg_dark") .section }}}"
{{- end }}{{- end }}

[module/keyboard]
type = internal/xkeyboard
format =   <label-layout><label-indicator>
blacklist-0 = caps lock
label-indicator-on-numlock = " 󰎠"
label-indicator-on-scrolllock = " "
{{ template "style" dict "separator" .separators.component.left "section" 1 "side" "l" "name" "" "component" true }}

[module/backlight]
type = internal/backlight
format = <ramp> <label>
ramp-0 = 󰛩
ramp-1 = 󱩎
ramp-2 = 󱩏
ramp-3 = 󱩐
ramp-4 = 󱩑
ramp-5 = 󱩒
ramp-6 = 󱩓
ramp-7 = 󱩔
ramp-8 = 󱩕
ramp-9 = 󱩖
ramp-10 = 󰛨
{{ template "style" dict "separator" .separators.component.left "section" 1 "side" "l" "name" "" "component" true }}

[module/alsa]
type = internal/alsa
format-volume = <ramp-volume> <label-volume> 
ramp-volume-0 = 
ramp-volume-1 = 
ramp-volume-2 = 
format-muted =  
{{ template "style" dict "separator" .separators.section.left "section" 1 "side" "l" "name" "volume" }}
{{ template "style" dict "separator" .separators.section.left "section" 1 "side" "l" "name" "muted" }}

[module/cava]
type = custom/script
exec = python3 ~/.config/polybar/scripts/info-cava.py -C"
{{- regexMatch "^tokyonight-(moon|night|storm)$" .colorscheme | ternary (list ($colors := get .tokyonight (regexFind "(moon|night|storm)$" .colorscheme)).fg $colors.yellow $colors.orange $colors.red | join ",") "" -}}
" -b80
tail = true

{{ if output "ls" "/sys/class/power_supply/" }}
[module/battery]
type = internal/battery
format-charging = <animation-charging> <label-charging>
format-discharging = <ramp-capacity> <label-discharging>
format-full = <ramp-capacity> <label-full>
format-low = <animation-low> <label-low>
ramp-capacity-0 = 󰂎
ramp-capacity-1 = 󰁺
ramp-capacity-2 = 󰁻
ramp-capacity-3 = 󰁼
ramp-capacity-4 = 󰁽
ramp-capacity-5 = 󰁾
ramp-capacity-6 = 󰁿
ramp-capacity-7 = 󰂀
ramp-capacity-8 = 󰂁
ramp-capacity-9 = 󰂂
ramp-capacity-10 = 󰁹
animation-charging-0 = 󰢟
animation-charging-1 = 󰢜
animation-charging-2 = 󰂆
animation-charging-3 = 󰂇
animation-charging-4 = 󰂈
animation-charging-5 = 󰢝
animation-charging-6 = 󰂉
animation-charging-7 = 󰢞
animation-charging-8 = 󰂊
animation-charging-9 = 󰂋
animation-charging-10 = 󰂅
animation-charging-framerate = 300
animation-low-0 = 󱃍
animation-low-1 = 󱃌
animation-low-framerate = 500
{{ template "style" dict "separator" .separators.section.right "section" 1 "side" "r" "name" "charging" }}
{{ template "style" dict "separator" .separators.section.right "section" 1 "side" "r" "name" "discharging" }}
{{ template "style" dict "separator" .separators.section.right "section" 1 "side" "r" "name" "full" }}
{{ template "style" dict "separator" .separators.section.right "section" 1 "side" "r" "name" "low" }}
{{ end }}

{{ if output "/bin/ls" "-1" "/sys/class/net/" | splitList "\n" | has "wlo1" }}
[module/wlan]
type = internal/network
interface-type = wireless
format-connected = <ramp-signal> <label-connected>
ramp-signal-0 = 󰤯
ramp-signal-1 = 󰤟
ramp-signal-2 = 󰤢
ramp-signal-3 = 󰤥
ramp-signal-4 = 󰤨
label-connected = %essid%
label-disconnected = 󰤭
{{ if output "ls" "/sys/class/power_supply/" }}
{{ template "style" dict "separator" .separators.component.right "section" 1 "side" "r" "name" "connected" "component" true }}
{{ template "style" dict "separator" .separators.component.right "section" 1 "side" "r" "name" "disconnected" "component" true }}
{{ else }}
{{ template "style" dict "separator" .separators.section.right "section" 1 "side" "r" "name" "connected" }}
{{ template "style" dict "separator" .separators.section.right "section" 1 "side" "r" "name" "disconnected" }}
{{ end }}
{{ end }}

[module/ethernet]
type = internal/network
interface-type = wired
format-connected = 󱘖 <label-connected>
{{ if output "/bin/ls" "/sys/class/power_supply/" | or (output "/bin/ls" "-1" "/sys/class/net/" | splitList "\n" | has "wlo1") }}
{{ template "style" dict "separator" .separators.component.right "section" 1 "side" "r" "name" "connected" "component" true }}
{{ else }}
{{ template "style" dict "separator" .separators.section.right "section" 1 "side" "r" "name" "connected" }}
{{ end }}

[module/bluetooth]
type = custom/script
exec = python3 ~/.config/polybar/scripts/bluetooth.py
{{ template "style" dict "separator" .separators.component.right "section" 1 "side" "r" "name" "" "component" true }}

[module/time]
type = internal/date
time = %T
label = "%time%  "
{{ template "style" dict "separator" .separators.section.right "section" 0 "side" "r" "name" "" }}

[module/bspwm]
type = internal/bspwm
pin-workspaces = true
inline-mode = true
label-separator = %{T2}{{ .separators.component.right }}%{T-}
label-separator-padding = 1
label-focused = %name%
label-focused-underline = ${colors.black}
label-occupied = %name%
label-empty = %name%
label-urgent = %name%
{{ template "style" dict "separator" .separators.component.right "section" 0 "side" "r" "name" "" "component" true }}
